#!/usr/bin/env node

'use strict';

const fs = require('fs');

const stringify = require('json-stringify-pretty-compact');
const argv = require('optimist')
    .usage('Usage: $0 <path> ...')
    .argv;

const collect = require('..');

argv._.forEach(run);

function run(path) {
    if (path === '-') {
        path = '/dev/stdin';
    }

    try {
        const {schemas} = collect(path);

        console.log(stringify(schemas));
    } catch (ex) {
        console.error(ex.message);
        console.error(ex.stack);
    }
}
